# Analytic Test Queries

Count all records in sales table

```SQL
SELECT COUNT(ID) FROM "GS"."SALES"
```

Count all records in orders view

```SQL
SELECT COUNT(SID) FROM "GS"."V_ORDERS" LIMIT 1
```

Show all orders quantity of product type

```SQL
SELECT PRODUCT_TYPE, COUNT(PRODUCT_TYPE) AS QTY FROM "GS"."V_ORDERS" GROUP BY PRODUCT_TYPE
```

Show all orders profit of product type

```SQL
SELECT PRODUCT_TYPE, SUM(PROFIT) AS QTY FROM "GS"."V_ORDERS" GROUP BY PRODUCT_TYPE
```

Show five most profitable lines of all time

```SQL
SELECT MANUFACTURER, PRODUCT_NAME, SUM(PROFIT) AS PROFIT FROM "GS"."V_ORDERS" GROUP BY MANUFACTURER, PRODUCT_NAME ORDER BY PROFIT DESC LIMIT 5
```

SHOW PROFIT FOR THE LAST 12 MONTHS

```SQL
SELECT YEAR(DATE) AS YEAR, MONTH(DATE) AS MONTH, SUM(PROFIT) AS PROFIT FROM "GS"."V_ORDERS" WHERE DATE < NOW() AND DATE > ADD_YEARS(NOW(),-1) GROUP BY DATE ORDER BY YEAR DESC, MONTH DESC
```

SHOW PROFIT BY YEAR ALL TIME

```SQL
SELECT YEAR(DATE) AS YEAR, SUM(PROFIT) AS PROFIT FROM "GS"."V_ORDERS" GROUP BY YEAR(DATE) ORDER BY YEAR DESC
```

SHOW 10 MOST PROFITABLE CITIES IN THE LAST 12 MONTHS

```SQL
SELECT CITY, SUM(PROFIT) FROM "GS"."V_ORDERS" WHERE DATE < NOW() AND DATE > ADD_YEARS(NOW(),-1) GROUP BY CITY ORDER BY SUM(PROFIT) DESC LIMIT 10
```

SALES QTY BY PRODUCT TYPE ALL TIME

```SQL
SELECT PRODUCT_TYPE, COUNT(PRODUCT_TYPE) AS QTY FROM "GS"."V_ORDERS" GROUP BY PRODUCT_TYPE ORDER BY COUNT(PRODUCT_TYPE) DESC
PRODUCT_TYPE,QTY
```

FIND ALL TIME QUANTITY OF ALL PRODUCTS OF A RANDOMLY SELECTED COLOUR IN A RANDOMLY SELECTED CITY

```SQL
SELECT CITY, COLOUR, COUNT(CITY) AS QTY FROM "GS"."V_ORDERS" WHERE CITY = (SELECT CITY FROM "GS"."CUSTOMERS" ORDER BY RAND() LIMIT 1) AND COLOUR = (SELECT COLOUR FROM "GS"."PRODUCT_COLOUR" ORDER BY RAND() LIMIT 1) GROUP BY CITY, COLOUR
```
